
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Auditing allows administrators to track
and log user activity on a MongoDB server.
With auditing enabled, the server will generate an audit log file.
This file contains information about different user events
including authentication, authorization failures, and so on.">
      
      
        <meta name="author" content="Percona LLC">
      
      
        <link rel="canonical" href="https://docs.percona.com/percona-server-for-mongodb/4.2/audit-logging.html">
      
      <link rel="icon" href="_images/percona-favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-8.5.10">
    
    
      
        <title>Auditing - Percona Server for MongoDB 4.2</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Poppins";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://unicons.iconscout.com/release/v3.0.3/css/line.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
    
      <link rel="stylesheet" href="css/percona.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
              <!-- Google Tag Manager -->
              <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
              new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
              j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
              'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
              })(window,document,'script','dataLayer','GTM-WBVF48V');</script>
              <!-- End Google Tag Manager -->

              <!-- Google Tag Manager (noscript) -->
              <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WBVF48V"
              height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
              <!-- End Google Tag Manager (noscript) -->
              
    
    
                 
                 
                 
                 
                 
                 <meta property="og:type" content="website" />
                 <meta property="og:title" content="Percona Server for MongoDB 4.2 - Auditing" />
                 <meta property="og:image" content="https://docs.percona.com/percona-server-for-mongodb/4.2/_images/mongodb.png">
                 <meta property="og:url" content="https://docs.percona.com/percona-server-for-mongodb/">
                </head>
                <body>
                </body>
              </html>

              
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#auditing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
              <div>This documentation is for the end of life version of Percona Server for MongoDB 4.2 which is no longer supported. <br><strong><a href="https://www.percona.com/blog/mongodb-4-2-eol-implications/">Learn more about MongoDB 4.2 end of life implications</a>.</strong> See the <strong><a href= ../.>current documentation</a></strong>. </div>
             
            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://docs.percona.com" title="Percona Server for MongoDB 4.2" class="md-header__button md-logo" aria-label="Percona Server for MongoDB 4.2" data-md-component="logo">
      
  <img src="_images/percona-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Percona Server for MongoDB 4.2
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Auditing
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="percona-light" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/percona/psmdb-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/psmdb-docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.percona.com" title="Percona Server for MongoDB 4.2" class="md-nav__button md-logo" aria-label="Percona Server for MongoDB 4.2" data-md-component="logo">
      
  <img src="_images/percona-logo.svg" alt="logo">

    </a>
    Percona Server for MongoDB 4.2
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/percona/psmdb-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    percona/psmdb-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="comparison.html" class="md-nav__link">
        Percona Server for MongoDB feature comparison
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Install PSMDB
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Install PSMDB" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Install PSMDB
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/index.html" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/apt.html" class="md-nav__link">
        Install Percona Server for MongoDB on Debian and Ubuntu
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/yum.html" class="md-nav__link">
        Install Percona Server for MongoDB on Red Hat Enterprise Linux and derivatives
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/tarball.html" class="md-nav__link">
        Install Percona Server for MongoDB from binary tarball
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/docker.html" class="md-nav__link">
        Run Percona Server for MongoDB in a Docker container
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Features
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Features" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Features
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_1" type="checkbox" id="__nav_4_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_1">
          Storage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Storage" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Storage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="inmemory.html" class="md-nav__link">
        Percona Memory Engine
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Backup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Backup" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Backup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="hot-backup.html" class="md-nav__link">
        Hot Backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="backup-cursor.html" class="md-nav__link">
        $backupCursor and $backupCursorExtend aggregation stages
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Authentication
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Authentication" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Authentication
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="authentication.html" class="md-nav__link">
        Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="enable-auth.html" class="md-nav__link">
        Enable authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="sasl-auth.html" class="md-nav__link">
        Set up LDAP authentication with SASL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="x509-ldap.html" class="md-nav__link">
        Set up x.509 authentication and LDAP authorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="kerberos.html" class="md-nav__link">
        Setting up Kerberos authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="authorization.html" class="md-nav__link">
        LDAP authorization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ldap-setup.html" class="md-nav__link">
        Set up LDAP authentication and authorization using NativeLDAP
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Encryption
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Encryption" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Encryption
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="data-at-rest-encryption.html" class="md-nav__link">
        Data at rest encryption
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="vault.html" class="md-nav__link">
        HashiCorp Vault integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="kmip.html" class="md-nav__link">
        Using the Key Management Interoperability Protocol (KMIP)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="keyfile.html" class="md-nav__link">
        Local key management using a keyfile
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="encryption-mode-switch.html" class="md-nav__link">
        Migrate from key file encryption to HashiCorp Vault encryption
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Auditing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="audit-logging.html" class="md-nav__link md-nav__link--active">
        Auditing
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#audit-options" class="md-nav__link">
    Audit options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-message-syntax" class="md-nav__link">
    Audit message syntax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-filter-examples" class="md-nav__link">
    Audit filter examples
  </a>
  
    <nav class="md-nav" aria-label="Audit filter examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standard-query-selectors" class="md-nav__link">
    Standard query selectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regular-expressions" class="md-nav__link">
    Regular expressions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-and-write-operations" class="md-nav__link">
    Read and write operations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-auditing-of-authorization-success" class="md-nav__link">
    Enabling auditing of authorization success
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="rate-limit.html" class="md-nav__link">
        Profiling rate limit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="log-redaction.html" class="md-nav__link">
        Log redaction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="ngram-full-text-search.html" class="md-nav__link">
        Additional text search algorithm - ngram
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Manage PSMDB
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Manage PSMDB" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Manage PSMDB
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="set-parameter.html" class="md-nav__link">
        Tune parameters
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Upgrade
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Upgrade" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Upgrade
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/upgrade-from-40.html" class="md-nav__link">
        Upgrade from 4.0 to 4.2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/upgrade-from-mongodb.html" class="md-nav__link">
        Upgrade Percona Server for MongoDB
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="install/uninstall.html" class="md-nav__link">
        Uninstall Percona Server for MongoDB
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Release notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Release notes" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Release notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/index.html" class="md-nav__link">
        Release notes index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.24-24.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.24-24 (2023-03-09)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.23-23.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.23-23 (2022-11-08)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.22-22.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.22-22 (2022-09-06)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.21-21.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.21-21 (2022-06-29)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.20-20.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.20-20 (2022-05-23)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.19-19.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.19-19 (2022-03-29)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.18-18.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.18-18 (2022-01-19)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.17-17.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.17-17 (2021-10-11)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.15-16.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.15-16 (2021-07-26)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.14-15.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.14-15 (2021-05-13)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.13-14.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.13-14 (2021-04-01)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.12-13.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.12-13 (2021-02-03)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.11-12.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.11-12 (2020-12-07)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.10-11.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.10-11 (2020-11-02)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.9-10.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.9-10 (2020-10-09)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.9-9.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.9-9 (2020-09-03)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.8-8.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.8-8 (2020-07-07)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.7-7.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.7-7 (2020-06-04)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.6-6.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.6-6 (2020-05-07)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.5-5.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.5-5 (2020-04-02)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.3-4.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.3-4 (2020-02-20)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.2-3.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.2-3 (2019-12-24)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.1-1.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.1-1 (2019-11-13)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="release_notes/4.2.0-1.html" class="md-nav__link">
        Percona Server for MongoDB 4.2.0-1 (2019-09-09)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="glossary.html" class="md-nav__link">
        Glossary
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Copyright and Licensing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Copyright and Licensing" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Copyright and Licensing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="copyright.html" class="md-nav__link">
        Copyright and Licensing Information
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Trademark policy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Trademark policy" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Trademark policy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="trademark-policy.html" class="md-nav__link">
        Trademark Policy
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
    <br/>
   <label class="md-nav__title" for="__drawer">
    <a href="https://learn.percona.com/download-percona-server-mongodb-4-2-manual" onclick="_gaq.push(['b._trackEvent', 'Percona Server for MongoDB', 'Download', 'Download Manual Percona Server for MongoDB']);" class="md-nav__link md-nav__link--active">
      Download PDF
    </a>
  </label> 
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#audit-options" class="md-nav__link">
    Audit options
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-message-syntax" class="md-nav__link">
    Audit message syntax
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audit-filter-examples" class="md-nav__link">
    Audit filter examples
  </a>
  
    <nav class="md-nav" aria-label="Audit filter examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standard-query-selectors" class="md-nav__link">
    Standard query selectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#regular-expressions" class="md-nav__link">
    Regular expressions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-and-write-operations" class="md-nav__link">
    Read and write operations
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enabling-auditing-of-authorization-success" class="md-nav__link">
    Enabling auditing of authorization success
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

              <h1 id="auditing">Auditing<a class="headerlink" href="#auditing" title="Permanent link">&para;</a></h1>
<p>Auditing allows administrators to track
and log user activity on a MongoDB server.
With auditing enabled, the server will generate an audit log file.
This file contains information about different user events
including authentication, authorization failures, and so on.</p>
<p>To enable audit logging, specify where to send audit events
using the <a href="#-auditdestination"><code>--auditDestination</code></a> option on the command line
or the <code>auditLog.destination</code> variable in the configuration file.</p>
<p>If you want to output events to a file,
also specify the format of the file
using the <a href="#uauditformat"><code>--auditFormat</code></a> option
or the <code>auditLog.format</code> variable,
and the path to the file using the <a href="#-auditpath"><code>--auditPath</code></a> option
or the <code>auditLog.path</code> variable.</p>
<p>To filter recorded events, use the <a href="#-auditfilter"><code>--auditFilter</code></a> option
or the <code>auditLog.filter</code> variable.</p>
<p>For example, to log only events from a user named <strong>tim</strong>
and write them to a JSON file <code>/var/log/psmdb/audit.json</code>,
start the server with the following parameters:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>$<span class="w"> </span>mongod<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--dbpath<span class="w"> </span>data/db
<span class="w"> </span>--auditDestination<span class="w"> </span>file<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--auditFormat<span class="w"> </span>JSON<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--auditPath<span class="w"> </span>/var/log/psmdb/audit.json<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>--auditFilter<span class="w"> </span><span class="s1">&#39;{ &quot;users.user&quot; : &quot;tim&quot; }&#39;</span>
</code></pre></div>
<p>The options in the previous example can be used as variables
in the MongoDB configuration file:</p>
<div class="highlight"><pre><span></span><code>storage:
  dbPath: data/db
auditLog:
  destination: file
  format: JSON
  path: /var/log/psmdb/audit.json
  filter: &#39;{ &quot;users.user&quot; : &quot;tim&quot; }&#39;
</code></pre></div>
<p>This example shows how to send audit events to the
<code>syslog</code>. Specify the following parameters:</p>
<div class="highlight" data-prompt="$"><pre><span></span><code>mongod<span class="w"> </span><span class="se">\</span>
--dbpath<span class="w"> </span>data/db
--auditDestination<span class="w"> </span>syslog<span class="w"> </span><span class="se">\</span>
</code></pre></div>
<p>Alternatively, you can edit the MongoDB configuration file:</p>
<div class="highlight"><pre><span></span><code><span class="nt">storage</span><span class="p">:</span>
<span class="w"> </span><span class="nt">dbPath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/db</span>
<span class="nt">auditLog</span><span class="p">:</span>
<span class="w"> </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you start the server with auditing enabled, you cannot disable auditing dynamically during runtime.</p>
</div>
<h2 id="audit-options">Audit options<a class="headerlink" href="#audit-options" title="Permanent link">&para;</a></h2>
<p>The following options control audit logging:</p>
<table>
<thead>
<tr>
<th>Command line</th>
<th>Configuration file</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--auditDestination()</code></td>
<td><code>auditLog.destination</code></td>
<td>string</td>
<td>Enables auditing and specifies where to send audit events: <br> - <code>console</code>: Output audit events to <code>stdout</code>. <br> - <code>file</code>: Output audit events to a file specified by the <code>--auditPath</code> option in a format specified by the <code>--auditFormat</code> option. <br> - <code>syslog</code>: Output audit events to <code>syslog</code></td>
</tr>
<tr>
<td><code>--auditFilter()</code></td>
<td><code>auditLog.filter</code></td>
<td>string</td>
<td>Specifies a filter to apply to incoming audit events, enabling the administrator to only capture a subset of them. The value must be interpreted as a query object with the following syntax: <br><br><code>{ &lt;field1&gt;: &lt;expression1&gt;, ... }</code> <br><br> Audit log events that match this query will be logged. Events that do not match this query will be ignored. <br> For more information, see <a href="#audit-file-examples">Audit filter examples</a></td>
</tr>
<tr>
<td><code>--auditFormat()</code></td>
<td><code>auditLog.format</code></td>
<td>string</td>
<td>Specifies the format of the audit log file, if you set the <code>--auditDestination</code> option to <code>file</code>. <br> The default value is <code>JSON</code>. Alternatively, you can set it to <code>BSON</code></td>
</tr>
<tr>
<td><code>--auditPath()</code></td>
<td><code>auditLog.path</code></td>
<td>string</td>
<td>Specifies the fully qualified path to the file where audit log events are written, if you set the <code>--auditDestination</code> option to <code>file</code>. <br> If this option is not specified, then the <code>auditLog.json</code> file is created in the server’s configured log path. If log path is not configured on the server, then the <code>auditLog.json</code> file is created in the current directory (from which <code>mongod</code> was started). <br><br> <strong>NOTE</strong>: This file will rotate in the same manner as the system log path, either on server reboot or using the <code>logRotate</code> command. The time of rotation will be added to the old file’s name.</td>
</tr>
</tbody>
</table>
<h2 id="audit-message-syntax">Audit message syntax<a class="headerlink" href="#audit-message-syntax" title="Permanent link">&para;</a></h2>
<p>Audit logging writes messages in JSON format with the following syntax:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nx">atype</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">ts</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;$date&quot;</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">timestamp</span><span class="o">&gt;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">local</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ip</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="kr">int</span><span class="o">&gt;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">remote</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ip</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nx">port</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="kr">int</span><span class="o">&gt;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nx">users</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">user</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nx">db</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">],</span>
<span class="w">  </span><span class="nx">roles</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">role</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nx">db</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">],</span>
<span class="w">  </span><span class="nx">param</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nb">document</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">result</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="kr">int</span><span class="o">&gt;</span>
<span class="p">}</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>atype</code></td>
<td>Event type</td>
</tr>
<tr>
<td><code>ts</code></td>
<td>Date and UTC time of the event</td>
</tr>
<tr>
<td><code>local</code></td>
<td>Local IP address and port number of the instance</td>
</tr>
<tr>
<td><code>remote</code></td>
<td>Remote IP address and port number of the incoming connection associated with the event</td>
</tr>
<tr>
<td><code>users</code></td>
<td>Users associated with the event</td>
</tr>
<tr>
<td><code>roles</code></td>
<td>Roles granted to the user</td>
</tr>
<tr>
<td><code>param</code></td>
<td>Details of the event associated with the specific type</td>
</tr>
<tr>
<td><code>result</code></td>
<td>Exit code (<code>0</code> for success)</td>
</tr>
</tbody>
</table>
<h2 id="audit-filter-examples">Audit filter examples<a class="headerlink" href="#audit-filter-examples" title="Permanent link">&para;</a></h2>
<p>The following examples show the flexibility of audit log filters.</p>
<div class="highlight"><pre><span></span><code><span class="nt">auditLog</span><span class="p">:</span>
<span class="w">   </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">filter</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&#39;{atype:</span><span class="nv"> </span><span class="s">{$in:</span><span class="nv"> </span><span class="s">[</span>
<span class="w">         </span><span class="s">&quot;authenticate&quot;,</span><span class="nv"> </span><span class="s">&quot;authCheck&quot;,</span>
<span class="w">         </span><span class="s">&quot;renameCollection&quot;,</span><span class="nv"> </span><span class="s">&quot;dropCollection&quot;,</span><span class="nv"> </span><span class="s">&quot;dropDatabase&quot;,</span>
<span class="w">         </span><span class="s">&quot;createUser&quot;,</span><span class="nv"> </span><span class="s">&quot;dropUser&quot;,</span><span class="nv"> </span><span class="s">&quot;dropAllUsersFromDatabase&quot;,</span><span class="nv"> </span><span class="s">&quot;updateUser&quot;,</span>
<span class="w">         </span><span class="s">&quot;grantRolesToUser&quot;,</span><span class="nv"> </span><span class="s">&quot;revokeRolesFromUser&quot;,</span><span class="nv"> </span><span class="s">&quot;createRole&quot;,</span><span class="nv"> </span><span class="s">&quot;updateRole&quot;,</span>
<span class="w">         </span><span class="s">&quot;dropRole&quot;,</span><span class="nv"> </span><span class="s">&quot;dropAllRolesFromDatabase&quot;,</span><span class="nv"> </span><span class="s">&quot;grantRolesToRole&quot;,</span><span class="nv"> </span><span class="s">&quot;revokeRolesFromRole&quot;,</span>
<span class="w">         </span><span class="s">&quot;grantPrivilegesToRole&quot;,</span><span class="nv"> </span><span class="s">&quot;revokePrivilegesFromRole&quot;,</span>
<span class="w">         </span><span class="s">&quot;replSetReconfig&quot;,</span>
<span class="w">         </span><span class="s">&quot;enableSharding&quot;,</span><span class="nv"> </span><span class="s">&quot;shardCollection&quot;,</span><span class="nv"> </span><span class="s">&quot;addShard&quot;,</span><span class="nv"> </span><span class="s">&quot;removeShard&quot;,</span>
<span class="w">         </span><span class="s">&quot;shutdown&quot;,</span>
<span class="w">         </span><span class="s">&quot;applicationMessage&quot;</span>
<span class="w">      </span><span class="s">]}}&#39;</span>
</code></pre></div>
<h3 id="standard-query-selectors">Standard query selectors<a class="headerlink" href="#standard-query-selectors" title="Permanent link">&para;</a></h3>
<p>You can use query selectors,
such as <code>$eq</code>, <code>$in</code>, <code>$gt</code>, <code>$lt</code>, <code>$ne</code>, and others
to log multiple event types.</p>
<p>For example, to log only the <code>dropCollection</code> and <code>dropDatabase</code> events:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Command line</label><label for="__tabbed_1_2">Config file</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>--auditDestination<span class="w"> </span>file<span class="w"> </span>--auditFilter<span class="w"> </span><span class="s1">&#39;{ atype: { $in: [ &quot;dropCollection&quot;, &quot;dropDatabase&quot; ] } }&#39;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">auditLog</span><span class="p">:</span>
<span class="w">  </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">atype:</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">$in:</span><span class="nv"> </span><span class="s">[</span><span class="nv"> </span><span class="s">&quot;dropCollection&quot;,</span><span class="nv"> </span><span class="s">&quot;dropDatabase&quot;</span><span class="nv"> </span><span class="s">]</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">}&#39;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="regular-expressions">Regular expressions<a class="headerlink" href="#regular-expressions" title="Permanent link">&para;</a></h3>
<p>Another way to specify multiple event types is using regular expressions.</p>
<p>For example, to filter all <code>drop</code> operations:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Command line</label><label for="__tabbed_2_2">Config file</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>--auditDestination<span class="w"> </span>file<span class="w"> </span>--auditFilter<span class="w"> </span><span class="s1">&#39;{ &quot;atype&quot; : /^drop.*/ }&#39;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">auditLog</span><span class="p">:</span>
<span class="w">  </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">&quot;atype&quot;</span><span class="nv"> </span><span class="s">:</span><span class="nv"> </span><span class="s">/^drop.*/</span><span class="nv"> </span><span class="s">}&#39;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="read-and-write-operations">Read and write operations<a class="headerlink" href="#read-and-write-operations" title="Permanent link">&para;</a></h3>
<p>By default, operations with successful authorization are not logged,
so for this filter to work, enable <code>auditAuthorizationSuccess</code> parameter,
as described in <a href="#enabling-auditing-of-authorization-success">Enabling auditing of authorization success</a>.</p>
<p>For example, to filter read and write operations
on all the collections in the <code>test</code> database:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The dot (<code>.</code>) after the database name in the regular expression must be escaped with two backslashes (<code>\\\\</code>).</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Command line</label><label for="__tabbed_3_2">Config file</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>--setParameter<span class="w"> </span><span class="nv">auditAuthorizationSuccess</span><span class="o">=</span><span class="nb">true</span><span class="w"> </span>--auditDestination<span class="w"> </span>file<span class="w"> </span>--auditFilter<span class="w"> </span><span class="s1">&#39;{ atype: &quot;authCheck&quot;, &quot;param.command&quot;: { $in: [ &quot;find&quot;, &quot;insert&quot;, &quot;delete&quot;, &quot;update&quot;, &quot;findandmodify&quot; ] }, &quot;param.ns&quot;: /^test\\./ } }&#39;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">auditLog</span><span class="p">:</span>
<span class="w">  </span><span class="nt">destination</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">file</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;{</span><span class="nv"> </span><span class="s">atype:</span><span class="nv"> </span><span class="s">&quot;authCheck&quot;,</span><span class="nv"> </span><span class="s">&quot;param.command&quot;:</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">$in:</span><span class="nv"> </span><span class="s">[</span><span class="nv"> </span><span class="s">&quot;find&quot;,</span><span class="nv"> </span><span class="s">&quot;insert&quot;,</span><span class="nv"> </span><span class="s">&quot;delete&quot;,</span><span class="nv"> </span><span class="s">&quot;update&quot;,</span><span class="nv"> </span><span class="s">&quot;findandmodify&quot;</span><span class="nv"> </span><span class="s">]</span><span class="nv"> </span><span class="s">},</span><span class="nv"> </span><span class="s">&quot;param.ns&quot;:</span><span class="nv"> </span><span class="s">/^test\\./</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">}&#39;</span>

<span class="nt">setParameter</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt"> auditAuthorizationSuccess</span><span class="p">:</span><span class="w"> </span><span class="nv">true</span><span class="w"> </span><span class="p p-Indicator">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="enabling-auditing-of-authorization-success">Enabling auditing of authorization success<a class="headerlink" href="#enabling-auditing-of-authorization-success" title="Permanent link">&para;</a></h2>
<p>By default, only authorization failures for the <code>authCheck</code> action
are logged by the audit system. <code>authCheck</code> is for authorization by
role-based access control, it does not concern authentication at logins.</p>
<p>To enable logging of authorization successes,
set the <code>auditAuthorizationSuccess</code> parameter to <code>true</code>. Audit events
will then be triggered by every command, including CRUD ones.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Enabling the <code>auditAuthorizationSuccess</code> parameter heavily impacts the performance compared to logging only authorization failures.</p>
</div>
<p>You can enable it on a running server using the following command:</p>
<div class="highlight"><pre><span></span><code><span class="nx">db</span><span class="p">.</span><span class="nx">adminCommand</span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">setParameter</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="nx">auditAuthorizationSuccess</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>To enable it on the command line, use the following option
when running <code>mongod</code> or <code>mongos</code> process:</p>
<div class="highlight"><pre><span></span><code>--setParameter<span class="w"> </span><span class="nv">auditAuthorizationSuccess</span><span class="o">=</span><span class="nb">true</span>
</code></pre></div>
<p>You can also add it to the configuration file as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nt">setParameter</span><span class="p">:</span>
<span class="w">  </span><span class="nt">auditAuthorizationSuccess</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>

             
<div class="md-relbar2__inner md-grid">
<div class="md-content">
  <article class="md-content__inner md-typeset" role="main">    
    <h4>Contact Us </h4>
       <p>For free technical help, visit the Percona <a class="https://forums.percona.com/c/mongodb/percona-server-for-mongodb/17?utm_campaign=Doc%20pages" target="_blank">Community Forum</a>.<br>
        <p>To report bugs or submit feature requests, open a <a class="reference external" href="https://jira.percona.com/projects/PSMDB/issues/" target="_blank">JIRA</a> ticket.<br>
         <p>For paid <a class="reference external" href="https://www.percona.com/services/support"> support </a> and <a class="reference external" href="https://www.percona.com/services/managed-services"> managed </a> or <a class="reference external" href="https://www.percona.com/services/consulting">consulting services </a>, contact <a class="reference external" href="https://www.percona.com/about-percona/contact" target="_blank">Percona Sales</a>.</p>
 </article>
</div>
</div>

             
               <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 21, 2023</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">December 8, 2022</span>
      
    
  </small>
</div>
             

             
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="encryption-mode-switch.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Migrate from key file encryption to HashiCorp Vault encryption" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Migrate from key file encryption to HashiCorp Vault encryption
            </div>
          </div>
        </a>
      
      
        
        <a href="rate-limit.html" class="md-footer__link md-footer__link--next" aria-label="Next: Profiling rate limit" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Profiling rate limit
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
    <div class="md-copyright__highlight">
 <a href='https://percona.com' target='_blank'>Percona LLC and/or its affiliates, </a> &copy; 2023
    </div>
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better. Read more about <a class="reference external" href="https://www.percona.com/20180524-cookie-policy" target="_blank">Percona Cookie Policy</a>.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        <label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": ".", "features": ["search.highlight", "search.suggest", "search.share", "navigation.top", "navigation.tracking", "content.tabs.link", "content.action.edit", "content.action.view", "content.code.copy"], "search": "assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="js/version-select.js"></script>
      
        <script src="js/promptremover.js"></script>
      
    
    
  </body>
</html>