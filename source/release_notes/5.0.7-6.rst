.. _PSMDB-5.0.7-6:

================================================================================
*Percona Server for MongoDB* 5.0.7-6
================================================================================

:Date: April 20, 2022
:Installation: `Installing Percona Server for MongoDB <https://www.percona.com/doc/percona-server-for-mongodb/5.0/install/index.html>`_

Percona Server for MongoDB 5.0.7-6 is an enhanced, source-available and highly-scalable database that is a
fully-compatible, drop-in replacement for MongoDB 5.0.7 Community Edition.
It supports MongoDB 5.0.7 protocols and drivers.

.. note::

   This is the first version that is production capable as earlier upstream versions of MongoDB had the number of potential serious bugs.

Release Highlights
==================

|PSMDB| now supports :ref:`Keys Management Interoperability Protocol (KMIP) <kmip>` so that users can store encryption keys in their favorite KMIP-compatible key manager to set up encryption at rest. This is a tech preview feature. 

The list of bug fixes introduced by MongoDB and included in Percona Server for MongoDB is the following:

* `SERVER-63203 <https://jira.mongodb.org/browse/SERVER-63203>`_ - Fixed the issue where having a large number of split points causes the chunk splitter to not function correctly and huge chunks would not be split without manual intervention. This can be caused when having small shard key ranges and a very high number of documents and where more than 8192 split points would be needed.
* `SERVER-64517 <https://jira.mongodb.org/browse/SERVER-64517>`_ - Recover the ``RecoverableCriticalSection`` service after the ``initialSync`` and ``startupRecovery`` stages have completed. This prevents a started up shard to miss an in-memory critical section of a resharded collection.
* `SERVER-64403 <https://jira.mongodb.org/browse/SERVER-64403>`_ - Fixed an issue that occurred during the attempt to perform the collation-encoding of a document with a missing sort attribute. In this case an invariant is violated and ``mongod`` crashes. 
* `SERVER-63722 <https://jira.mongodb.org/browse/SERVER-63722>`_ - Fixed an issue when the rename collection (sharding step) participants can get stuck.
* `SERVER-61769 <https://jira.mongodb.org/browse/SERVER-61769>`_ - Fixed an issue with idle cursors remaining open when the client attempts to run an aggregation with ``$out`` or ``$merge`` in a transaction on a sharded cluster.  
* `SERVER-60412 <https://jira.mongodb.org/browse/SERVER-60412>`_ - Check if the host has cgroups v2 enabled and read the memory limits according to that.
* `WT-7922 <https://jira.mongodb.org/browse/WT-7922>`_ -  Report an error when the WiredTiger version file is empty or missing during a startup.

 
Find the full list of changes in the `MongoDB 5.0.7 Community Edition Release notes <https://www.mongodb.com/docs/manual/release-notes/5.0/#5.0.7---april-11--2022>`_.


New Features
================================================================================

* :jirabug:`PSMDB-971`: Added support for :abbr:`KMIP (Keys Management Interoperability Protocol)` encryption. Now users can store encryption keys in their favorite KMIP-compatible key manager to set up encryption at rest. 



Bugs Fixed
================================================================================

* :jirabug:`PSMDB-1010`: Fixed the parameters order in the ``LOGV2_DEBUG`` statement for LDAP logging.
* :jirabug:`PSMDB-957`: Fixed server crash caused by LDAP misconfiguration. Now the server logs an error message and exits.


