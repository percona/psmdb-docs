.. _PSMDB-4.2.20-20:

================================================================================
*Percona Server for MongoDB* 4.2.20-20 (2022-05-23)
================================================================================

:Date: May 23, 2022
:Installation: `Installing Percona Server for MongoDB <https://www.percona.com/doc/percona-server-for-mongodb/4.2/install/index.html>`_

Percona Server for MongoDB 4.2.20-20 is an enhanced, source-available, and highly-scalable database that is a
fully-compatible, drop-in replacement for MongoDB 4.2.20 Community Edition.
It supports MongoDB 4.2.20 protocols and drivers.

Release Highlights
==================

|PSMDB| now supports the master key rotation for data encrypted using the  :ref:`Keys Management Interoperability Protocol (KMIP) <kmip>` protocol (tech preview feature). This improvement allows users to comply with regulatory standards for data security.

Other improvements and bug fixes introduced by MongoDB and included in |PSMDB| are the following: 

* `SERVER-64983 <https://jira.mongodb.org/browse/SERVER-64983>`_ -  Abort the WiredTiger transaction after releasing Client lock to avoid deadlocks
* `SERVER-60412 <https://jira.mongodb.org/browse/SERVER-60412>`_ - Check if the host has ``cgroups`` v2 enabled and read the memory limits according to that.
* `SERVER-64642 <https://jira.mongodb.org/browse/SERVER-64642>`_ - Return the shutdown error as the top level error when batch writing command fails due to mongos shutdown.
* `SERVER-59435 <https://jira.mongodb.org/browse/SERVER-59435>`_ - Fixed the double free state for the ``DocumentSource::optimizeAt()`` pipeline by making sure all pointers are in place before disposing the pipeline prefix     

  
 Find the full list of changes in the `MongoDB 4.2.20 Community Edition release notes <https://www.mongodb.com/docs/manual/release-notes/4.2/#4.2.20---may-9--2022>`_

Improvements
================================================================================

* :jirabug:`PSMDB-1011`: Add KMIP master key rotation
* :jirabug:`PSMDB-1043`: The ``kmipClientCertificateFile`` option now includes both the client private key and public certificate
* :jirabug:`PSMDB-1044`: Make the ``kmipPort`` option not mandatory and assign the default value


Bugs Fixed
================================================================================

* :jirabug:`PSMDB-979`: Rotate audit logs in the mode as defined in the configuration.
* :jirabug:`PSMDB-1030`: Fix descriptions and mutual dependencies of KMIP related options for ``mongod`` and ``perconadecrypt``


.. include:: ../.res/replace.txt