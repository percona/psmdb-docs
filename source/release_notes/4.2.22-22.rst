.. _PSMDB-4.2.22-22:

================================================================================
*Percona Server for MongoDB* 4.2.22-22 (2022-09-06)
================================================================================

:Date: September 6, 2022
:Installation: `Installing Percona Server for MongoDB <https://www.percona.com/doc/percona-server-for-mongodb/4.2/install/index.html>`_

Percona Server for MongoDB 4.2.22-22 is an enhanced, source-available, and highly-scalable database that is a fully-compatible, drop-in replacement for MongoDB 4.2.22 Community Edition.
It supports MongoDB 4.2.22 protocols and drivers.

Release Highlights
==================

.. important::

   With this release, the ``kmipKeyIdentifier`` option for data-at-rest encryption using the KMIP protocol (tech preview feature) is optional. This change serves to improve the user experience with |PSMDB| as the option names and behavior are similar to those of MongoDB Enterprise. However, if data-at-rest encryption using KMIP is configured, it is the breaking change because the standard upgrade procedure does not work. We do recommend to use the data-at-rest encryption using the KMIP protocol only for testing purposes until it is in the general availability stage.

   If you have configured data at rest encryption and it is absolutely necessary to upgrade your MongoDB instance, see the :ref:`upgrade instructions <upgrade-kmip>`.


The changes and bug fixes introduced by MongoDB include the following:

* `SERVER-64403 <https://jira.mongodb.org/browse/SERVER-64403>`_ - Fixed an issue that occurred during the attempt to perform the collation-encoding of a document with a missing sort attribute. In this case an invariant is violated and ``mongod`` crashes.
* `SERVER-68359 <https://jira.mongodb.org/browse/SERVER-68359>`_ - Fixed the TTLMonitor behavior to skip processing TTL indexes if the expireAfterSeconds option value is NaN (Not a Number).
* `SERVER-62656 <https://jira.mongodb.org/browse/SERVER-62656>`_ - Changed the behavior of the ShardingTaskExecutorPoolSize parameter to control the connection pool size for config server replica set and shard nodes separately.
* `SERVER-66418 <https://jira.mongodb.org/browse/SERVER-66418>`_ - Fixed the issue with bad projection created during dependency analysis due to string order assumption. It resulted in the ``PathCollision`` error. The issue is fixed by improving dependency analysis for projections by folding dependencies into ancestor dependencies where possible.
  
Find the full list of changes in the `MongoDB 4.2.22 Community Edition release notes <https://www.mongodb.com/docs/manual/release-notes/4.2/#4.2.22---aug-19--2022>`_.

Improvements
================================================================================

* :jirabug:`PSMDB-1046`: Make the ``kmipKeyIdentifier`` option not mandatory
  


Bugs Fixed
================================================================================

* :jirabug:`PSMDB-1119`: Fixed the issue with backup cursor not opening if data-at-rest encryption is enabled

Packaging Notes
===============

Debian 9 (“Stretch”) is no longer supported. 
